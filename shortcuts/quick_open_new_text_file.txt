import os
from pathlib import Path
import subprocess

def create_and_open_file():
    # Get desktop path
    desktop_path = Path.home() / "Desktop"
    
    # Base filename
    base_name = "new_file"
    counter = 0
    
    # Keep trying until we find an available filename
    while True:
        # Generate filename with counter
        if counter == 0:
            filename = f"{base_name}.txt"
        else:
            filename = f"{base_name}_{counter}.txt"
            
        # Full path
        file_path = desktop_path / filename
        
        # Check if file exists
        if not file_path.exists():
            try:
                # Create the file
                with open(file_path, 'w') as f:
                    f.write("")  # Create empty file
                
                # Open with notepad
                try:
                    subprocess.Popen(['notepad.exe', str(file_path)])
                    print(f"Created and opened: {filename}")
                    break
                except subprocess.SubprocessError as e:
                    print(f"Error opening Notepad: {e}")
                    print(f"File was created at: {file_path}")
                    break
                    
            except IOError as e:
                print(f"Error creating file: {e}")
                break
        
        # Increment counter and try next number
        counter += 1

if __name__ == "__main__":
    create_and_open_file()
